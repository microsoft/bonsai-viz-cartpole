(this.webpackJsonpcartpoleviz=this.webpackJsonpcartpoleviz||[]).push([[0],{12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeMode=t.QueryParams=t.MessageType=t.CompatibleVersion=t.Version=void 0,t.Version="1.0.0",t.CompatibleVersion="1.x",function(e){e.IterationUpdate="IterationUpdate"}(t.MessageType||(t.MessageType={})),function(e){e.Theme="_theme",e.Context="_context",e.PrefsKey="_prefsKey",e.Lang="_lang"}(t.QueryParams||(t.QueryParams={})),function(e){e.Light="light",e.Dark="dark"}(t.ThemeMode||(t.ThemeMode={}))},41:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);n(41);var i=n(11),o=n(38),a=n.n(o),r=n(0),s=n(1),c=n(2),l=n(3),d=n(12),h=n(39),p=n(5),_=n(40),m=n(15),u=new p.w(0,0,1),v=.01,w=.25,f=.2,y=.02,g=.08,M=.00125,b=[.22,.3,.38],k=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e))._container=null,i._scene=void 0,i._camera=void 0,i._renderer=void 0,i._pole=void 0,i._cart=void 0,i._poleMaterial=void 0,i._wheels=[],i._onMount=function(e){i._container=e},i._onWindowResize=function(){var e=window.innerWidth,t=window.innerHeight;i._camera&&i._renderer&&(i._camera.aspect=e/t,i._camera.updateProjectionMatrix(),i._renderer.setSize(e,t))},i.state={},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=window.innerWidth,n=window.innerHeight;this._renderer=new p.x({antialias:!0}),this._scene=new p.v;var i=new p.e(v,v,w,32);this._poleMaterial=new p.n({}),this._poleMaterial.color.set(this._getPoleColor());var o=new p.m(i,this._poleMaterial);o.position.y=.125,this._pole=new p.p,this._pole.castShadow=!0,this._pole.add(o),this._scene.add(this._pole),(new _.a).load("wheel.obj",(function(i){i.scale.set(M,M,M),i.traverse((function(e){if("plastic"===e.name){var t=e.material;t.color.copy(new p.d("#666666")),t.metalness=1}"rubber"===e.name&&e.material.color.copy(new p.d("#111111"))})),e._cart=new p.p,e._scene.add(e._cart),[[.06,.675*g],[-.06,.675*g],[.06,.675*-.08],[-.06,.675*-.08]].forEach((function(t){var n=new p.p,o=i.clone();n.add(o),n.translateX(t[0]),n.translateY(-.01),n.translateZ(t[1]),e._wheels.push(n),e._cart.add(n)}));var o=new p.b(f,y,g),a=new p.o({color:new p.d(.3,.3,.3),reflectivity:1,shininess:150}),r=new p.m(o,a);e._cart.add(r),e._renderer.setSize(t,n),e._renderer.shadowMap.enabled=!0,e._renderer.shadowMap.type=p.q,e._camera=new p.r(40,t/n,.1,1e3),e._camera.position.z=.5,e._camera.position.y=.125,e._camera.lookAt(0,.105,0),[[-.25,.5,0],[.25,.5,0]].forEach((function(t){var n=new p.s(16777215,.85,50,1.25);n.position.set(t[0],t[1],t[2]),n.lookAt(0,0,0),e._scene.add(n)}));var s=new p.a(16777215,1.5);e._scene.add(s),window.addEventListener("resize",e._onWindowResize,!1),e._container.appendChild(e._renderer.domElement)}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._onWindowResize)}},{key:"render",value:function(){var e=this;return this.props.isModelValid&&this._render3DScene(),Object(m.jsx)("div",{ref:function(t){return e._onMount(t)}})}},{key:"_getPoleColor",value:function(){return new p.d(b[0],b[1],b[2])}},{key:"_render3DScene",value:function(){if(this._scene&&this._pole&&this._cart&&this._renderer&&this._camera){var e="light"===this.props.theme?16777215:1710618;this._scene.background=new p.d(e);var t=new p.w(this.props.model.state.position,Math.sin(Math.abs(this.props.model.state.angle))*v,0);this._pole.position.copy(t),this._pole.setRotationFromAxisAngle(u,-this.props.model.state.angle);var n=new p.w(this.props.model.state.position,-.01,0);this._cart.position.copy(n);var i=-this.props.model.state.position/.045;this._wheels.forEach((function(e){e.setRotationFromAxisAngle(u,i)})),this._renderer.render(this._scene,this._camera)}}}]),n}(i.Component),j=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var i;Object(r.a)(this,n),(i=t.call(this,e))._receiveMessage=function(e){if("message"===e.type){var t=e.data;if("string"===typeof t){var n;try{n=JSON.parse(t)}catch(r){return}if(h.satisfies(n.version,d.CompatibleVersion)&&n.type===d.MessageType.IterationUpdate){var o,a=n.state;o=void 0!==a.position?{theme:i.state.theme,isModelValid:!0,model:{state:{position:a.position,velocity:a.velocity,angle:a.angle}}}:void 0!==a.x?{theme:i.state.theme,isModelValid:!0,model:{state:{position:a.x,velocity:a.x_dot,angle:a.theta}}}:{theme:i.state.theme,isModelValid:!0,model:{state:{position:a.cart_position,velocity:a.cart_velocity,angle:a.pole_angle}}},i.setState(o)}}}};var o=new URLSearchParams(window.location.search),a=i._getInitialTheme(o);return i.state={theme:a,isModelValid:!0,model:{state:{position:0,velocity:0,angle:0}}},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("message",this._receiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this._receiveMessage)}},{key:"render",value:function(){return Object(m.jsx)(k,{theme:this.state.theme,isModelValid:this.state.isModelValid,model:this.state.model})}},{key:"_getInitialTheme",value:function(e){return e.get(d.QueryParams.Theme)===d.ThemeMode.Dark?d.ThemeMode.Dark:d.ThemeMode.Light}}]),n}(i.Component);a.a.render(Object(m.jsx)(j,{}),document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.38eee3e3.chunk.js.map